{% extends "base.html" %}
{% block title %}Sessions – WSZ6 Portal{% endblock %}

{% block content %}
<h1>Sessions</h1>
<div class="card">
  <form class="search-bar" method="get">
    <input type="text" name="q" value="{{ q }}" placeholder="Search by game or owner…">
    <button type="submit" class="btn btn-primary">Search</button>
    {% if q %}<a href="?" class="btn">Clear</a>{% endif %}
  </form>
  <table>
    <tr><th>Game</th><th>Owner</th><th>Status</th><th>Started</th><th>Ended</th><th></th></tr>
    {% for s in sessions %}
    <tr>
      <td>{{ s.game.name }}</td>
      <td>{{ s.owner.username }}</td>
      <td><span class="badge badge-{{ s.status }}">{{ s.get_status_display }}</span></td>
      <td>{{ s.started_at|date:"Y-m-d H:i" }}</td>
      <td>{{ s.ended_at|date:"Y-m-d H:i"|default:"—" }}</td>
      <td>
        {% if s.status == 'open' %}
          <a href="{% url 'wsz6_play:join' s.session_key %}" class="btn btn-sm btn-primary">Join</a>
        {% elif s.status == 'in_progress' %}
          <a href="{% url 'wsz6_play:join' s.session_key %}" class="btn btn-sm btn-success">Rejoin</a>
        {% elif s.status == 'paused' %}
          <a href="{% url 'wsz6_play:join' s.session_key %}" class="btn btn-sm btn-warning">Resume</a>
        {% endif %}
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="6">No sessions yet.</td></tr>
    {% endfor %}
  </table>
</div>
{% endblock %}
