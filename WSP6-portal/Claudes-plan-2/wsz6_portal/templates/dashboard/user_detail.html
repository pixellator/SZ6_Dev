{% extends "base.html" %}
{% block title %}{{ target.username }} – WSZ6 Portal{% endblock %}

{% block content %}
<h1>User: {{ target.username }}</h1>
<div style="display:grid; grid-template-columns:1fr 1fr; gap:1rem; align-items:start;">

  <div class="card">
    <h2>Edit Settings</h2>
    <form method="post">
      {% csrf_token %}
      {% for field in form %}
        <p>
          <label for="{{ field.id_for_label }}">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}<div class="helptext">{{ field.help_text }}</div>{% endif %}
          {% if field.errors %}<ul class="errorlist">{% for e in field.errors %}<li>{{ e }}</li>{% endfor %}</ul>{% endif %}
        </p>
      {% endfor %}
      <button type="submit" class="btn btn-success">Save changes</button>
    </form>
  </div>

  <div>
    <div class="card">
      <h2>Account Info</h2>
      <table>
        <tr><th>Last login</th><td>{{ target.last_login|date:"Y-m-d H:i"|default:"Never" }}</td></tr>
        <tr><th>Date joined</th><td>{{ target.date_joined|date:"Y-m-d" }}</td></tr>
        <tr><th>Active</th><td>{% if target.is_active %}Yes{% else %}No{% endif %}</td></tr>
      </table>
    </div>
    <div class="card">
      <h2>Recent Sessions</h2>
      <table>
        <tr><th>Game</th><th>Status</th><th>Started</th></tr>
        {% for s in sessions %}
        <tr>
          <td>{{ s.game.name }}</td>
          <td><span class="badge badge-{{ s.status }}">{{ s.get_status_display }}</span></td>
          <td>{{ s.started_at|date:"Y-m-d H:i" }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="3">No sessions yet.</td></tr>
        {% endfor %}
      </table>
    </div>
  </div>

</div>
<a href="{% url 'dashboard:user_list' %}" style="display:inline-block; margin-top:.5rem;">← Back to users</a>
{% endblock %}
