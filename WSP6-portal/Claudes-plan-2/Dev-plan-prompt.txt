Dev-plan-prompt.txt

This file contains the main prompt intended for Claude Code
to create a development plan for the WSZ6-portal system,
which is a web site to host users, administrators, and games,
such that the games can be played online.  All the games
will be in the SOLUZION6 format.  Each game will be represented
by a folder of files that includes a main "problem formulation
file" or PFF written in Python.  Optional additional files may
be other Python files, image files, or other resources needed
to run the game that are game specific.

As we plan the development of this web portal, we'll need
to refer to several files that explain how things should work.
In addition to this file (Dev-plan-prompt.txt),
several other files
should be consulted, in order to understand the system
requirements. But before we look at those files, let us
consider the overall system architecture.
The web portal system (let's call it WSZ6-portal)
will have two main components, an administrative component with
user accounts (WSZ6-admin) and a game-play management component
(WSZ6-play).

Thus, WSZ6-portal = WSZ6-admin + WSZ6-play.

Assume that WSZ6-admin will be a typical Django installation,
with different types of user and admin accounts (specified
in wsz6-portal.txt).

Assume that WSZ6-play will be implemented using one or more
Django Channels.  Part of WSZ6-play will handle the initiation
and continuation of game-play sessions, with particular groups
of users and a particular game.  Another part of WSZ6-play will
by the game engine that runs PFF code for state changes in the
game, generating state displays, and handling any other in-game
interaction.

There will be two databases. One will contain user account data
including records of which game-play sessions each user was
involved with.  This database will also include a repository
for all the games that have been entered into the portal, and
this repository will include some of the metadata for each game.

The second database will contain game-play log files and
related evidence from game sessions, such as documents created
during games that involve writing or other document-editing
tasks.

Supporting the second database and WSZ6-play will be a games
repository with one folder for each game. This is where the
PFF and other resources related to each game will be stored.

An important architectural consideration is the design of
the interface between WSZ6-admin and WSZ6-play.  We anticipate
that WSZ6-play will need updating frequently for a few weeks,
early on (during the first year of use), and that WSZ6-admin
will need fewer updates, and perhaps mostly later on, when
administration of games and activities becomes more important
than getting all the game features working.

Two typical workflows are game-setup and game-play.

For game-setup, a user with permission to install a new game
or modify an existing game will log into the system, fill
out or edit existing entries in a game-metadata form, and
upload a zip file with the folder containing the PFF for the
game and other resource files.

For game-play, a user with permission to start a play-through
session for a particular game will log on, select a game
for which s/he has permission, create a session,
and then invite one or more
players (by sending out system-generated URLs over email
or by text) to join the new session and play the game.
Those invited players can join by clicking on the link,
and giving their name (optional).  The user who initiated
the session is the session owner and can start the game
when enough players have joined.  The game's PFF can
specify a minimum number of players.  The session owner
can also assign game roles to bots if desired.  What bots
are available will depend on what version of this system
is running.  Initially there will only be one bot, and
that bot will either play randomly or always choose the
first option when moving; that bot is more of a placeholder
for possible future bots than anything else.
The game may end naturally, say be reaching a goal state
as specified in its PFF.  It may also be terminated by
the session owner.  It can also be interrupted due to
timeouts or explicit "Pause" action on the part of the
session owner.  When interrupted, the game history and
current state should be automatically persisted by the
system, so that the owner and other players can log in
again later and continue the game.

The means of communication between WSZ6-admin and WSZ6-play
should support these workflows, at least.

Another scenario that should be supported is a game-debugging
mode, such that the game-setup workflow is augmented such that
after the new game is set up or updated, the user can click
on "Start in debug mode" and the game will automatically launch
with a default list of simulated players, whose screens show
up as separate tabs in the user's browser.  This can be
especially helpful when debugging role-specific state visualizations
in games.

One more scenario is "admin joins" in which a user with special
permissions can get a list of ongoing game sessions and
join in a game, as an active player if allowed by the game's
spec, or as an observer if not.  In that observer role, the
admin can, for example, choose one of the players in the session
to see what that player sees in real time.  This feature will
likely be used in educational contexts as well as demos and
debugging.

Finally, there is the scenario in which a user, acting as a
researcher, can log into the portal and get access to game-play
information, either to inspect it directly, or in order to
pull it into tools that do analytics. These tools might be
offline to begin with but perhaps later integrated into
WSZ6-admin.

So with these workflows and scenarios in mind, please structure
the interface between WSZ6-admin and WSZ6-play so that one side
can be updated without breaking the other side.

Regarding scaling.  While we don't expect large number of users
or simultaneous game sessions in the near future, the dev plan
should mention what steps will be necessary to support scaling
up shoud the need arise.  In the meantime, the system should be
able to support at least 10, and ideally, 50 simultaneous
play sessions.

Now here are the additional files to consult:

../wsz6-portal-v2.txt

../../SZ6-spec/SZ6-specification-overview.txt
 (also in this folder, particular files giving more
  details on individual features mentioned in
  SZ6-specification-overview.txt)

For WSZ6-play, see the introduction to problem formulation
in:
  ../../Textual_SZ6/What-is-a-problem-formulation.txt

and also see the working prototype of a game engine for
running games in a standalone PC, non-networked setup
with only textual interaction.  That game engine is:
  ../../Textual_SZ6/Textual_SOLUTION6.py

There are six sample problem formulations in the same
subfolder, such as Missionaries.py.  The game engine
in WSZ6-play should be capable for running game sessions
with each of these formulations (and any others that
conform to the SOLUZION6 formulation requirements).

When these games are run, log files or records will be generated
that represent traces of the game playing. Ideally, these
will be "replay complete" meaning that they capture enough
information that the game sessions could be replayed,
say for purposes or research, evaluation, or management
analytics.  The logs should be stored in the database associate
with WSZ6-play.

When designing WSZ6-play, it might be helpful to see how
a game engine for SOLUZION5 (the preceding version of SOLUZION)
was implemented, although that was using Flask, whereas for
WSZ6-play, we want Django Channels.  In any case, code of that
old system is available in

../../../SZ5/Dev_Web_SOLUZION5/Web_SOLUZION5/Web_SZ5_01.py.
That system was not integrated with any full administrative 
component.  It was functional, but had a number of bugs
(e.g., mixing up the role assignments for different game
sessions) and it would not support the new formulation file
structure that has formulations as instances of classes
rather than global properties of the problem formulation
module.

Along with the old system code is a handbook describing
the old version (5) of SOLUZION.  That handbook is in

../../../SZ5/Dev_Web_SOLUZION5/Web_SOLUZION5/soluzion5handbook.pdf

Only read that if there is a pressing issue about how the old
SOLUZION5 materials were supposed to work.

Please give a detailed development plan for WSZ6-portal and
put in a file here WSZ6-portal-dev-plan.md.
